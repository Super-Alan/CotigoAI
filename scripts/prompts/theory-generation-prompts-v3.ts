/**
 * Theory Content V3 - AI Prompt Templates
 *
 * Enhanced prompts for generating high-quality theory content.
 * Based on design document: docs/theory-system-redesign/05-CONTENT-GENERATION-V3.md
 */

/**
 * Level configuration interface
 */
export interface LevelConfig {
  level: number;
  levelTitle: string;
  cognitiveLoad: string;
  learningGoals: string[];
  difficulty: 'beginner' | 'intermediate' | 'advanced';
}

/**
 * Dimension configuration interface
 */
export interface DimensionConfig {
  id: string;
  name: string;
  description: string;
}

/**
 * Generate Concepts Prompt (æ ¸å¿ƒæ¦‚å¿µ)
 *
 * @param dimension - Thinking dimension configuration
 * @param levelConfig - Level-specific configuration
 * @returns Formatted prompt for AI model
 */
export function CONCEPTS_PROMPT_V3(
  dimension: DimensionConfig,
  levelConfig: LevelConfig
): string {
  const { level, levelTitle, cognitiveLoad, learningGoals } = levelConfig;

  return `ä½ æ˜¯ä¸€ä½èµ„æ·±çš„æ‰¹åˆ¤æ€§æ€ç»´æ•™è‚²ä¸“å®¶å’Œè¯¾ç¨‹è®¾è®¡å¤§å¸ˆ,æ“…é•¿å°†å¤æ‚ç†è®ºè½¬åŒ–ä¸ºç»“æž„åŒ–ã€æ˜“ç†è§£çš„å­¦ä¹ å†…å®¹ã€‚

**ðŸš¨ å…³é”®è¦æ±‚ - è¯·åŠ¡å¿…ä¸¥æ ¼éµå®ˆ**:
1. **å¿…é¡»è¿”å›žçº¯JSONæ ¼å¼** - ä¸è¦æ·»åŠ ä»»ä½•è§£é‡Šæ€§æ–‡å­—ã€å‰è¨€æˆ–åŽç¼€
2. **JSONå¿…é¡»å®Œæ•´ä¸”æ ¼å¼æ­£ç¡®** - ç¡®ä¿æ‰€æœ‰æ‹¬å·ã€å¼•å·ã€é€—å·æ­£ç¡®é—­åˆ
3. **å­—ç¬¦ä¸²ä¸­çš„ç‰¹æ®Šå­—ç¬¦å¿…é¡»è½¬ä¹‰** - å¦‚å¼•å·ä½¿ç”¨ \\" , æ¢è¡Œä½¿ç”¨ \\n
4. **è¿”å›žæ ¼å¼**: ç›´æŽ¥è¾“å‡ºJSONå¯¹è±¡ï¼Œä¸è¦ç”¨markdownä»£ç å—åŒ…è£¹

## ä»»åŠ¡èƒŒæ™¯

è¯·ä¸ºä»¥ä¸‹ç»´åº¦å’ŒLevelè®¾è®¡æ ¸å¿ƒæ¦‚å¿µå†…å®¹:

**æ€ç»´ç»´åº¦**: ${dimension.name}
**ç»´åº¦æè¿°**: ${dimension.description}
**Level**: ${level} - ${levelTitle}
**è®¤çŸ¥è´Ÿè·**: ${cognitiveLoad}
**å­¦ä¹ ç›®æ ‡**: ${learningGoals.join('; ')}

## è¾“å‡ºæ ¼å¼è¦æ±‚

**ðŸŽ¯ è¾“å‡ºç¤ºä¾‹**:
ç›´æŽ¥è¿”å›žä»¥ä¸‹æ ¼å¼çš„JSONå¯¹è±¡ï¼Œä¸è¦æœ‰ä»»ä½•é¢å¤–æ–‡å­—:
{
  "intro": "æœ¬ç« èŠ‚å¼•è¨€(200-300å­—,è¯´æ˜Žæœ¬Levelè¦å­¦ä»€ä¹ˆæ¦‚å¿µ,ä¸ºä»€ä¹ˆé‡è¦)",

  "concepts": [
    {
      "conceptId": "å”¯ä¸€æ ‡è¯†ç¬¦(è‹±æ–‡kebab-case,å¦‚: causal-relationship-standards)",
      "name": "æ¦‚å¿µåç§°(ä¸­æ–‡,ç®€æ´ç²¾å‡†,å¦‚: å› æžœå…³ç³»çš„ä¸‰ä¸ªåˆ¤å®šæ ‡å‡†)",

      "coreIdea": "æ ¸å¿ƒç†å¿µ(ä¸€å¥è¯ç²¾é«“,50-80å­—,å¦‚: åˆ¤æ–­çœŸæ­£çš„å› æžœå…³ç³»éœ€è¦æ»¡è¶³æ—¶é—´å…ˆåŽã€é€»è¾‘å¿…ç„¶ã€æŽ’é™¤æ··æ·†ä¸‰ä¸ªæ ¸å¿ƒæ ‡å‡†)",

      "definition": "ç²¾ç¡®å®šä¹‰(100-150å­—,å­¦æœ¯å‡†ç¡®ä½†é€šä¿—æ˜“æ‡‚)",
      "whyImportant": "ä¸ºä»€ä¹ˆé‡è¦(80-120å­—,è¯´æ˜ŽæŽŒæ¡è¿™ä¸ªæ¦‚å¿µçš„ä»·å€¼)",

      "conceptBreakdown": {
        "level1": {
          "title": "ç¬¬ä¸€å±‚å­æ¦‚å¿µæ ‡é¢˜",
          "definition": "å®šä¹‰(100-150å­—)",
          "whyImportant": "é‡è¦æ€§è¯´æ˜Ž",
          "example": "å…·ä½“ç¤ºä¾‹",
          "practicalTest": "å¦‚ä½•æ£€éªŒæ˜¯å¦ç†è§£(å®žç”¨æµ‹è¯•æ–¹æ³•)"
        },
        "level2": {
          "title": "ç¬¬äºŒå±‚å­æ¦‚å¿µæ ‡é¢˜(å¦‚é€‚ç”¨)",
          "definition": "å®šä¹‰",
          "whyImportant": "é‡è¦æ€§",
          "example": "ç¤ºä¾‹",
          "practicalTest": "æ£€éªŒæ–¹æ³•"
        },
        "level3": {
          "title": "ç¬¬ä¸‰å±‚å­æ¦‚å¿µæ ‡é¢˜(å¦‚é€‚ç”¨)",
          "definition": "å®šä¹‰",
          "whyImportant": "é‡è¦æ€§",
          "example": "ç¤ºä¾‹",
          "practicalTest": "æ£€éªŒæ–¹æ³•"
        }
      },

      "criticalThinkingFramework": {
        "step1": "ç¬¬ä¸€æ­¥æ£€éªŒæ–¹æ³•(å¦‚: æ—¶é—´æ£€æŸ¥ - åŽŸå› æ˜¯å¦å…ˆäºŽç»“æžœ?)",
        "step2": "ç¬¬äºŒæ­¥æ£€éªŒæ–¹æ³•(å¦‚: å˜åŒ–æ£€æŸ¥ - åŽŸå› æ”¹å˜æ—¶ç»“æžœæ˜¯å¦æ”¹å˜?)",
        "step3": "ç¬¬ä¸‰æ­¥æ£€éªŒæ–¹æ³•(å¦‚: æ··æ·†æ£€æŸ¥ - æ˜¯å¦æœ‰ç¬¬ä¸‰æ–¹å˜é‡?)",
        "step4": "ç¬¬å››æ­¥æ£€éªŒæ–¹æ³•(å¯é€‰,å¦‚: æœºåˆ¶æ£€æŸ¥ - èƒ½å¦è§£é‡Šä¸ºä»€ä¹ˆ?)"
      },

      "keyPoints": [
        "æ ¸å¿ƒè¦ç‚¹1(30-50å­—)",
        "æ ¸å¿ƒè¦ç‚¹2(30-50å­—)",
        "æ ¸å¿ƒè¦ç‚¹3(30-50å­—)",
        "æ ¸å¿ƒè¦ç‚¹4(å¯é€‰)",
        "æ ¸å¿ƒè¦ç‚¹5(å¯é€‰)"
      ],

      "commonMisconceptions": [
        {
          "misconception": "å¸¸è§è¯¯åŒºæè¿°(å¦‚: ç›¸å…³æ€§ç­‰äºŽå› æžœæ€§)",
          "truth": "æ­£ç¡®ç†è§£(å¦‚: ç›¸å…³æ€§åªæ˜¯å› æžœçš„å¿…è¦æ¡ä»¶,ä¸æ˜¯å……åˆ†æ¡ä»¶)",
          "realExample": "çœŸå®žæ¡ˆä¾‹å¯¹æ¯”(å¦‚: éž‹ç å¤§å°ä¸Žé˜…è¯»èƒ½åŠ›æ­£ç›¸å…³(å„¿ç«¥æ•°æ®),ä½†éž‹ç ä¸æ˜¯é˜…è¯»èƒ½åŠ›çš„åŽŸå› )"
        },
        {
          "misconception": "è¯¯åŒº2",
          "truth": "æ­£ç¡®ç†è§£2",
          "realExample": "æ¡ˆä¾‹2"
        }
      ],

      "realWorldExamples": [
        {
          "scenario": "åœºæ™¯æè¿°(100-150å­—,çœŸå®žè´´è¿‘ç”Ÿæ´»)",
          "application": "å¦‚ä½•åº”ç”¨è¯¥æ¦‚å¿µ",
          "outcome": "åº”ç”¨ç»“æžœ/æ´žå¯Ÿ"
        },
        {
          "scenario": "åœºæ™¯2",
          "application": "åº”ç”¨2",
          "outcome": "ç»“æžœ2"
        }
      ],

      "visualizationGuide": {
        "type": "decision-tree | flowchart | comparison-matrix | concept-map",
        "description": "å¯è§†åŒ–å›¾ç¤ºè¯´æ˜Ž(æè¿°å¦‚ä½•ç»˜åˆ¶è¿™ä¸ªå›¾)",
        "structure": {
          "root": "æ ¹èŠ‚ç‚¹/èµ·ç‚¹",
          "branch1": "åˆ†æ”¯1æè¿°",
          "branch2": "åˆ†æ”¯2æè¿°",
          "branch3": "åˆ†æ”¯3(å¦‚é€‚ç”¨)",
          "legend": "å›¾ä¾‹è¯´æ˜Ž"
        }
      }
    }
  ]
}

## è´¨é‡è¦æ±‚ (å¿…é¡»ä¸¥æ ¼éµå®ˆ!)

### ç»“æž„å®Œæ•´æ€§
- âœ… å¿…é¡»åŒ…å«${getLevelConceptCount(level)}ä¸ªæ¦‚å¿µ
- âœ… æ¯ä¸ªæ¦‚å¿µå¿…é¡»æœ‰conceptBreakdown(è‡³å°‘level1${level >= 3 ? ',æŽ¨èlevel1+level2' : ''})
- âœ… æ¯ä¸ªæ¦‚å¿µå¿…é¡»æœ‰criticalThinkingFramework(è‡³å°‘3æ­¥)
- âœ… æ¯ä¸ªæ¦‚å¿µå¿…é¡»æœ‰visualizationGuide

### å†…å®¹è´¨é‡
- âœ… coreIdeaå¿…é¡»æ˜¯ä¸€å¥è¯ç²¾é«“,èƒ½å¿«é€ŸæŠ“ä½æ ¸å¿ƒ
- âœ… conceptBreakdownè¦å±‚å±‚é€’è¿›,é€»è¾‘æ¸…æ™°
- âœ… commonMisconceptionså¿…é¡»æ˜¯çœŸå®žå¸¸è§çš„é”™è¯¯,ä¸èƒ½ç¼–é€ 
- âœ… realWorldExampleså¿…é¡»è´´è¿‘ç”¨æˆ·ç»éªŒ,ä¸èƒ½è¿‡äºŽå­¦æœ¯åŒ–

### å­—æ•°è¦æ±‚
- âœ… intro: 200-300å­—
- âœ… coreIdea: 50-80å­—
- âœ… definition: 100-150å­—
- âœ… whyImportant: 80-120å­—
- âœ… conceptBreakdownæ¯å±‚definition: 100-150å­—

${getLevelDifficultyGuidance(level)}

## ðŸš¨ æœ€åŽæé†’ - JSONæ ¼å¼è¦æ±‚

1. **ç›´æŽ¥è¾“å‡ºJSONå¯¹è±¡** - ç¬¬ä¸€ä¸ªå­—ç¬¦å°±æ˜¯ { , æœ€åŽä¸€ä¸ªå­—ç¬¦æ˜¯ }
2. **ä¸è¦ä½¿ç”¨markdownä»£ç å—** - ä¸è¦æœ‰ \`\`\`json è¿™æ ·çš„åŒ…è£¹
3. **ç¡®ä¿JSONå®Œæ•´** - æ‰€æœ‰å¯¹è±¡å’Œæ•°ç»„å¿…é¡»æ­£ç¡®é—­åˆ
4. **ç‰¹æ®Šå­—ç¬¦è½¬ä¹‰** - å­—ç¬¦ä¸²ä¸­çš„å¼•å·ã€æ¢è¡Œç¬¦ç­‰å¿…é¡»æ­£ç¡®è½¬ä¹‰
5. **éªŒè¯åŽå†è¿”å›ž** - åœ¨å¿ƒé‡Œæ£€æŸ¥JSONæ ¼å¼æ˜¯å¦å®Œæ•´æ­£ç¡®

**æ­£ç¡®ç¤ºä¾‹**: { "intro": "...", "concepts": [...] }
**é”™è¯¯ç¤ºä¾‹**: \`\`\`json\\n{ "intro": "...", "concepts": [...] }\\n\`\`\`

çŽ°åœ¨,è¯·ç›´æŽ¥è¾“å‡ºç¬¦åˆä¸Šè¿°è¦æ±‚çš„JSONå¯¹è±¡:`;
}

/**
 * Generate Single Model Prompt (ç”Ÿæˆå•ä¸ªæ€ç»´æ¨¡åž‹)
 *
 * @param dimension - Thinking dimension configuration
 * @param levelConfig - Level-specific configuration
 * @param modelIndex - Which model to generate (1-based: 1, 2, 3)
 * @param existingModels - Already generated models to avoid duplication
 * @returns Formatted prompt for AI model
 */
export function SINGLE_MODEL_PROMPT_V3(
  dimension: DimensionConfig,
  levelConfig: LevelConfig,
  modelIndex: number,
  existingModels: string[] = []
): string {
  const { level, levelTitle, cognitiveLoad } = levelConfig;

  return `ä½ æ˜¯ä¸€ä½æ‰¹åˆ¤æ€§æ€ç»´æ–¹æ³•è®ºä¸“å®¶å’Œæ•™å­¦è®¾è®¡å¤§å¸ˆ,æ“…é•¿è®¾è®¡å®žç”¨çš„æ€ç»´å·¥å…·å’Œåˆ†æžæ¡†æž¶ã€‚

**ðŸš¨ å…³é”®è¦æ±‚ - è¯·åŠ¡å¿…ä¸¥æ ¼éµå®ˆ**:
1. **åªç”Ÿæˆ1ä¸ªæ€ç»´æ¨¡åž‹** - è¿™æ˜¯ç¬¬${modelIndex}ä¸ªæ¨¡åž‹,è¿”å›žå•ä¸ªæ¨¡åž‹å¯¹è±¡(ä¸æ˜¯æ•°ç»„)
2. **å¿…é¡»è¿”å›žçº¯JSONæ ¼å¼** - ä¸è¦æ·»åŠ ä»»ä½•è§£é‡Šæ€§æ–‡å­—ã€å‰è¨€æˆ–åŽç¼€
3. **JSONå¿…é¡»å®Œæ•´ä¸”æ ¼å¼æ­£ç¡®** - ç¡®ä¿æ‰€æœ‰æ‹¬å·ã€å¼•å·ã€é€—å·æ­£ç¡®é—­åˆ
4. **å­—ç¬¦ä¸²ä¸­çš„ç‰¹æ®Šå­—ç¬¦å¿…é¡»è½¬ä¹‰** - å¦‚å¼•å·ä½¿ç”¨ \\" , æ¢è¡Œä½¿ç”¨ \\n
5. **è¿”å›žæ ¼å¼**: ç›´æŽ¥è¾“å‡ºJSONå¯¹è±¡ï¼Œä¸è¦ç”¨markdownä»£ç å—åŒ…è£¹
6. **æ€ç»´æ¨¡åž‹æ­¥éª¤æè¿°å¿…é¡»â‰¥300å­—** - è¿™æ˜¯æœ€é‡è¦çš„è´¨é‡è¦æ±‚!
${existingModels.length > 0 ? `7. **é¿å…é‡å¤** - å·²ç”Ÿæˆçš„æ¨¡åž‹: ${existingModels.join(', ')}, è¯·è®¾è®¡ä¸åŒçš„æ¨¡åž‹` : ''}

## ä»»åŠ¡èƒŒæ™¯

ä½ æ­£åœ¨ä¸ºä»¥ä¸‹ç»´åº¦å’ŒLevelè®¾è®¡ç¬¬${modelIndex}ä¸ªæ€ç»´æ¨¡åž‹:

**æ€ç»´ç»´åº¦**: ${dimension.name}
**ç»´åº¦æè¿°**: ${dimension.description}
**Level**: ${level} - ${levelTitle}
**è®¤çŸ¥è´Ÿè·**: ${cognitiveLoad}

## è¾“å‡ºæ ¼å¼è¦æ±‚

**ðŸŽ¯ è¾“å‡ºç¤ºä¾‹**:
ç›´æŽ¥è¿”å›žå•ä¸ªæ¨¡åž‹å¯¹è±¡ï¼Œä¸è¦æœ‰ä»»ä½•é¢å¤–æ–‡å­—:
{
  "modelId": "å”¯ä¸€æ ‡è¯†ç¬¦(è‹±æ–‡kebab-case,å¦‚: five-whys-analysis)",
  "name": "æ¨¡åž‹åç§°(ä¸­æ–‡,ç®€æ´å¥½è®°,å¦‚: 5-Whyåˆ†æžæ³•)",
  "purpose": "æ¨¡åž‹ç”¨é€”(50-80å­—,ä¸€å¥è¯è¯´æ˜Žç”¨æ¥åšä»€ä¹ˆ)",
  "description": "æ¨¡åž‹è¯´æ˜Ž(200-300å­—,è¯¦ç»†ä»‹ç»æ¨¡åž‹çš„èƒŒæ™¯ã€åŽŸç†ã€ä»·å€¼)",

  "coreLogic": {
    "principle": "åº•å±‚åŽŸç†(ä¸ºä»€ä¹ˆè¿™ä¸ªæ¡†æž¶æœ‰æ•ˆ,ç†è®ºåŸºç¡€æ˜¯ä»€ä¹ˆ,150-200å­—)",
    "whenWorks": "ä»€ä¹ˆæƒ…å†µä¸‹æœ‰æ•ˆ(é€‚ç”¨åœºæ™¯,80-120å­—)",
    "whenFails": "ä»€ä¹ˆæƒ…å†µä¸‹å¤±æ•ˆ(ä¸é€‚ç”¨åœºæ™¯,å±€é™æ€§,80-120å­—)"
  },

  "structure": {
    "type": "linear | matrix | network | hierarchy",
    "components": ["ç»„ä»¶1", "ç»„ä»¶2", "ç»„ä»¶3"],
    "relationships": "ç»„ä»¶ä¹‹é—´çš„å…³ç³»è¯´æ˜Ž(å¦‚: é¡ºåºæ‰§è¡Œã€çŸ©é˜µäº¤å‰ã€ç½‘ç»œå…³è”)"
  },

  "steps": [
    {
      "stepNumber": 1,
      "title": "æ­¥éª¤æ ‡é¢˜(åŠ¨è¯å¼€å¤´,å¦‚: ç²¾ç¡®å®šä¹‰é—®é¢˜èŒƒå›´)",
      "description": "è¯¦ç»†æ“ä½œè¯´æ˜Ž(300-500å­—!)\\n\\nå¿…é¡»åŒ…å«:\\n- å…·ä½“åšä»€ä¹ˆ(What)\\n- å¦‚ä½•åš(How)\\n- ä¸ºä»€ä¹ˆè¿™æ ·åš(Why)\\n- é¢„æœŸè¾“å‡ºæ˜¯ä»€ä¹ˆ(Output)",
      "keyThinkingPoints": ["æ€è€ƒè¦ç‚¹1", "æ€è€ƒè¦ç‚¹2", "æ€è€ƒè¦ç‚¹3"],
      "commonPitfalls": [{"mistake": "å¸¸è§é”™è¯¯", "example": "é”™è¯¯ç¤ºä¾‹", "correction": "å¦‚ä½•çº æ­£"}],
      "practicalExample": "å®žé™…æ¡ˆä¾‹è¯´æ˜Ž",
      "tips": "å®žç”¨æŠ€å·§",
      "nextStepRationale": "ä¸ºä»€ä¹ˆä¸‹ä¸€æ­¥å¾ˆé‡è¦"
    }
  ],

  "visualization": {
    "type": "flowchart | diagram | table | mindmap",
    "description": "å¯è§†åŒ–æè¿°(å¦‚ä½•ç”»è¿™ä¸ªå›¾,åŒ…å«å“ªäº›å…ƒç´ )",
    "legend": "å›¾ä¾‹è¯´æ˜Ž(ç¬¦å·å«ä¹‰,é¢œè‰²ç¼–ç ç­‰)",
    "stepByStepDrawing": ["ç»˜å›¾æ­¥éª¤1", "ç»˜å›¾æ­¥éª¤2", "ç»˜å›¾æ­¥éª¤3"]
  },

  "whenToUse": "é€‚ç”¨åœºæ™¯(80-120å­—,ä»€ä¹ˆæƒ…å†µä¸‹åº”è¯¥ç”¨è¿™ä¸ªæ¨¡åž‹)",
  "limitations": "å±€é™æ€§(50-80å­—,ä»€ä¹ˆæƒ…å†µä¸‹ä¸é€‚ç”¨æˆ–æ•ˆæžœä¸ä½³)",

  "fullApplicationExample": {
    "scenario": "å®Œæ•´èƒŒæ™¯æè¿°(200-300å­—,è®¾å®šä¸€ä¸ªçœŸå®žå¤æ‚çš„åœºæ™¯)",
    "stepByStepApplication": [
      {
        "step": 1,
        "action": "æ­¥éª¤1çš„å…·ä½“æ“ä½œ",
        "thinking": "æ€è€ƒè¿‡ç¨‹(ä¸ºä»€ä¹ˆè¿™æ ·åš,è€ƒè™‘äº†å“ªäº›å› ç´ )",
        "output": "è¯¥æ­¥éª¤çš„è¾“å‡ºç»“æžœ(å…·ä½“å†…å®¹æˆ–æ•°æ®)"
      }
    ],
    "outcome": "æœ€ç»ˆç»“æžœ(100-150å­—,åº”ç”¨æ¨¡åž‹åŽè§£å†³äº†ä»€ä¹ˆé—®é¢˜,å¾—åˆ°äº†ä»€ä¹ˆæ´žå¯Ÿ)"
  }
}

## è´¨é‡è¦æ±‚ (å¿…é¡»ä¸¥æ ¼éµå®ˆ!)

### æ­¥éª¤è¯¦ç»†åº¦ (æ ¸å¿ƒè¦æ±‚!)
- âœ… **æ¯ä¸ªæ­¥éª¤descriptionå¿…é¡»â‰¥300å­—** - è¿™æ˜¯æœ€é‡è¦çš„è´¨é‡è¦æ±‚!
- âœ… æ¯ä¸ªæ­¥éª¤å¿…é¡»åŒ…å«3-5ä¸ªkeyThinkingPoints
- âœ… æ¯ä¸ªæ­¥éª¤å¿…é¡»åŒ…å«2-3ä¸ªcommonPitfalls
- âœ… æ¯ä¸ªæ­¥éª¤å¿…é¡»æœ‰practicalExampleå’Œtips
- âœ… æ¯ä¸ªæ­¥éª¤(é™¤æœ€åŽä¸€æ­¥)å¿…é¡»æœ‰nextStepRationale

### æ¨¡åž‹å®Œæ•´æ€§
- âœ… å¿…é¡»æœ‰coreLogicè¯´æ˜Ž(principle + whenWorks + whenFails)
- âœ… å¿…é¡»æœ‰å®Œæ•´çš„visualization(åŒ…å«stepByStepDrawing)
- âœ… å¿…é¡»æœ‰fullApplicationExample(è¦†ç›–æ‰€æœ‰æ­¥éª¤)

${getLevelModelComplexityGuidance(level)}

## ðŸš¨ æœ€åŽæé†’ - JSONæ ¼å¼è¦æ±‚

1. **ç›´æŽ¥è¾“å‡ºå•ä¸ªæ¨¡åž‹JSONå¯¹è±¡** - ç¬¬ä¸€ä¸ªå­—ç¬¦å°±æ˜¯ { , æœ€åŽä¸€ä¸ªå­—ç¬¦æ˜¯ }
2. **ä¸è¦ä½¿ç”¨markdownä»£ç å—** - ä¸è¦æœ‰ \`\`\`json è¿™æ ·çš„åŒ…è£¹
3. **ç¡®ä¿JSONå®Œæ•´** - æ‰€æœ‰å¯¹è±¡å’Œæ•°ç»„å¿…é¡»æ­£ç¡®é—­åˆ
4. **ç‰¹æ®Šå­—ç¬¦è½¬ä¹‰** - å­—ç¬¦ä¸²ä¸­çš„å¼•å·ã€æ¢è¡Œç¬¦ç­‰å¿…é¡»æ­£ç¡®è½¬ä¹‰
5. **æ­¥éª¤æè¿°â‰¥300å­—** - è¿™æ˜¯è´¨é‡åº•çº¿,å¿…é¡»è¾¾åˆ°!

**æ­£ç¡®ç¤ºä¾‹**: { "modelId": "...", "name": "...", "steps": [...] }
**é”™è¯¯ç¤ºä¾‹**: \`\`\`json\\n{ "modelId": "...", "name": "..." }\\n\`\`\`

çŽ°åœ¨,è¯·ç›´æŽ¥è¾“å‡ºç¬¦åˆä¸Šè¿°è¦æ±‚çš„å•ä¸ªæ¨¡åž‹JSONå¯¹è±¡:`;
}

/**
 * Generate Demonstrations Prompt (å®žä¾‹æ¼”ç¤º)
 *
 * @param dimension - Thinking dimension configuration
 * @param levelConfig - Level-specific configuration
 * @param conceptsList - List of concepts from generated concepts content
 * @param modelsList - List of models from generated models content
 * @returns Formatted prompt for AI model
 */
export function DEMONSTRATIONS_PROMPT_V3(
  dimension: DimensionConfig,
  levelConfig: LevelConfig,
  conceptsList: string[],
  modelsList: string[]
): string {
  const { level, levelTitle } = levelConfig;

  return `ä½ æ˜¯ä¸€ä½æ‰¹åˆ¤æ€§æ€ç»´æ¡ˆä¾‹åˆ†æžä¸“å®¶å’Œæ•™å­¦è®¾è®¡å¤§å¸ˆ,æ“…é•¿é€šè¿‡è¯¦ç»†æ¡ˆä¾‹å±•ç¤ºç†è®ºåº”ç”¨ã€‚

**ðŸš¨ å…³é”®è¦æ±‚ - è¯·åŠ¡å¿…ä¸¥æ ¼éµå®ˆ**:
1. **å¿…é¡»ç”Ÿæˆ2ä¸ªå®žä¾‹æ¼”ç¤º** - demonstrationsæ•°ç»„ä¸­å¿…é¡»åŒ…å«2ä¸ªå®Œæ•´çš„æ¼”ç¤ºæ¡ˆä¾‹
2. **å¿…é¡»è¿”å›žçº¯JSONæ ¼å¼** - ä¸è¦æ·»åŠ ä»»ä½•è§£é‡Šæ€§æ–‡å­—ã€å‰è¨€æˆ–åŽç¼€
3. **JSONå¿…é¡»å®Œæ•´ä¸”æ ¼å¼æ­£ç¡®** - ç¡®ä¿æ‰€æœ‰æ‹¬å·ã€å¼•å·ã€é€—å·æ­£ç¡®é—­åˆ
4. **å­—ç¬¦ä¸²ä¸­çš„ç‰¹æ®Šå­—ç¬¦å¿…é¡»è½¬ä¹‰** - å¦‚å¼•å·ä½¿ç”¨ \\" , æ¢è¡Œä½¿ç”¨\\n
5. **è¿”å›žæ ¼å¼**: ç›´æŽ¥è¾“å‡ºJSONå¯¹è±¡ï¼Œä¸è¦ç”¨markdownä»£ç å—åŒ…è£¹
6. **æ¯æ­¥å¿…é¡»æ ‡æ³¨conceptApplied** - è¿™æ˜¯æ ¸å¿ƒè¦æ±‚!

## ä»»åŠ¡èƒŒæ™¯

è¯·ä¸ºä»¥ä¸‹ç»´åº¦å’ŒLevelè®¾è®¡å®žä¾‹æ¼”ç¤ºå†…å®¹:

**æ€ç»´ç»´åº¦**: ${dimension.name}
**Level**: ${level} - ${levelTitle}

**å·²æœ‰ç†è®ºå†…å®¹**(è¯·åœ¨æ¡ˆä¾‹ä¸­å¼•ç”¨):
- æ ¸å¿ƒæ¦‚å¿µ: ${conceptsList.join(', ')}
- æ€ç»´æ¨¡åž‹: ${modelsList.join(', ')}

## è¾“å‡ºæ ¼å¼è¦æ±‚

**ðŸŽ¯ è¾“å‡ºç¤ºä¾‹**:
ç›´æŽ¥è¿”å›žä»¥ä¸‹æ ¼å¼çš„JSONå¯¹è±¡ï¼Œä¸è¦æœ‰ä»»ä½•é¢å¤–æ–‡å­—:
{
  "intro": "æœ¬ç« èŠ‚å¼•è¨€(100-150å­—,è¯´æ˜Žæ¡ˆä¾‹çš„å­¦ä¹ ä»·å€¼,èƒ½å­¦åˆ°ä»€ä¹ˆ)",

  "demonstrations": [
    {
      "demoId": "å”¯ä¸€æ ‡è¯†ç¬¦(å¦‚: ecommerce-retention-analysis)",
      "title": "æ¡ˆä¾‹æ ‡é¢˜(ç®€æ´å¸å¼•äºº,å¦‚: ç”µå•†å¹³å°ç”¨æˆ·æµå¤±çš„å¤šå› ç´ å½’å› åˆ†æž)",
      "category": "åœºæ™¯ç±»åˆ«(å¦‚: å•†ä¸šåˆ†æž | ç”Ÿæ´»å†³ç­– | å­¦æœ¯ç ”ç©¶ | å…¬å…±æ”¿ç­–)",

      "learningObjective": "æœ¬æ¡ˆä¾‹å­¦ä¹ ç›®æ ‡(80-120å­—,å¦‚: æœ¬æ¡ˆä¾‹æ¼”ç¤ºå¦‚ä½•ç»¼åˆè¿ç”¨'å› æžœä¸‰æ ‡å‡†'å’Œ'é±¼éª¨å›¾åˆ†æžæ³•'è¿›è¡Œç³»ç»Ÿæ€§é—®é¢˜è¯Šæ–­)",

      "theoreticalFoundation": {
        "conceptsUsed": [
          "å› æžœå…³ç³»åˆ¤å®šä¸‰æ ‡å‡† (æ ¸å¿ƒæ¦‚å¿µ1.1)",
          "ä¸»è¦åŽŸå› vsæ¬¡è¦åŽŸå›  (æ ¸å¿ƒæ¦‚å¿µ2.2)"
        ],
        "modelsUsed": [
          "é±¼éª¨å›¾åˆ†æžæ³• (æ€ç»´æ¨¡åž‹2.1)"
        ]
      },

      "scenario": {
        "background": "è¯¦ç»†èƒŒæ™¯æè¿°(300-400å­—)\\n\\nå¿…é¡»åŒ…å«:\\n- ä¸»ä½“ä»‹ç»(è°/ä»€ä¹ˆç»„ç»‡)\\n- æ—¶é—´èƒŒæ™¯\\n- é—®é¢˜æƒ…å¢ƒ\\n- å…³é”®åˆ©ç›Šç›¸å…³è€…",

        "keyData": [
          "å…³é”®æ•°æ®ç‚¹1(å¦‚: æ•´ä½“ç”¨æˆ·ç•™å­˜çŽ‡: 70% â†’ 45%, ä¸‹é™25ä¸ªç™¾åˆ†ç‚¹)",
          "å…³é”®æ•°æ®ç‚¹2(å¦‚: æ–°ç”¨æˆ·7æ—¥ç•™å­˜: 65% â†’ 30%, ä¸‹é™35ä¸ªç™¾åˆ†ç‚¹)",
          "å…³é”®æ•°æ®ç‚¹3(å¦‚: è€ç”¨æˆ·ç•™å­˜: 85% â†’ 82%, åŸºæœ¬ç¨³å®š)"
        ],

        "problemStatement": "æ ¸å¿ƒé—®é¢˜(50-80å­—,å¦‚: å¦‚ä½•è¯†åˆ«å¯¼è‡´ç”¨æˆ·æµå¤±çš„æ ¹æœ¬åŽŸå› ,å¹¶åŒºåˆ†ä¸»è¦åŽŸå› å’Œæ¬¡è¦åŽŸå› ?)"
      },

      "stepByStepAnalysis": [
        {
          "stepNumber": 1,
          "action": "åº”ç”¨XXç†è®º/æ¨¡åž‹ - å…·ä½“æ“ä½œ",

          "conceptApplied": "ä½¿ç”¨äº†å“ªä¸ªæ¦‚å¿µ(å¿…é¡»æ˜Žç¡®æ ‡æ³¨,å¦‚: ç²¾ç¡®é—®é¢˜å®šä¹‰ (æ€ç»´æ¨¡åž‹2.1æ­¥éª¤1))",
          "modelApplied": "ä½¿ç”¨äº†å“ªä¸ªæ¨¡åž‹(å¯é€‰,å¦‚: é±¼éª¨å›¾åˆ†æžæ³• (æ€ç»´æ¨¡åž‹2.1))",

          "thinkingProcess": "å®Œæ•´æ€ç»´è¿‡ç¨‹(200-300å­—!)\\n\\nå¿…é¡»åŒ…å«:\\n- ä¸ºä»€ä¹ˆé€‰æ‹©è¿™ä¸ªç†è®º/æ¨¡åž‹?\\n- å…·ä½“å¦‚ä½•åº”ç”¨?\\n- é‡åˆ°äº†ä»€ä¹ˆæŒ‘æˆ˜?\\n- å¦‚ä½•å…‹æœ?\\n- å¾—å‡ºäº†ä»€ä¹ˆä¸­é—´ç»“è®º?",

          "criticalThinkingPoint": "ðŸŽ¯ å…³é”®æ€è€ƒç‚¹(80-120å­—,å¦‚: ä¸ºä»€ä¹ˆèšç„¦æ–°ç”¨æˆ·? å› ä¸ºæ•°æ®æ˜¾ç¤ºè€ç”¨æˆ·ç•™å­˜åŸºæœ¬ç¨³å®š,æ–°ç”¨æˆ·ä¸‹é™å¹…åº¦æ›´å¤§,ç¬¦åˆ'æŠ“ä¸»è¦çŸ›ç›¾'åŽŸåˆ™)",

          "toolOutput": "è¯¥æ­¥éª¤çš„è¾“å‡ºç»“æžœ(å¯ä»¥æ˜¯å­—ç¬¦ä¸²ã€å¯¹è±¡æˆ–æ•°ç»„)",

          "nextStepRationale": "ä¸ºä»€ä¹ˆè¦è¿›è¡Œä¸‹ä¸€æ­¥(å¦‚: é—®é¢˜å®šä¹‰æ¸…æ™°åŽ,ä¸‹ä¸€æ­¥éœ€è¦ç³»ç»Ÿæ€§è¯†åˆ«æ‰€æœ‰å¯èƒ½çš„å½±å“å› ç´ )"
        }
      ],

      "keyInsights": [
        {
          "insight": "æ´žå¯Ÿç‚¹æ ‡é¢˜(50-80å­—)",
          "explanation": "è¯¦ç»†è§£é‡Š(100-150å­—)",
          "generalPrinciple": "å¯è¿ç§»çš„é€šç”¨åŽŸåˆ™(å¦‚: å½“æ•´ä½“æŒ‡æ ‡æ¶åŒ–æ—¶,é€šè¿‡åˆ†å±‚åˆ†æžèƒ½é¿å…è¯¯åˆ¤)",
          "applicableScenarios": "é€‚ç”¨åœºæ™¯(å¦‚: é€‚ç”¨äºŽæ‰€æœ‰èšåˆæŒ‡æ ‡çš„åˆ†æž: é”€å”®ä¸‹æ»‘ã€è½¬åŒ–çŽ‡é™ä½Žç­‰)"
        }
      ],

      "commonMistakesInThisCase": [
        {
          "mistake": "é”™è¯¯æè¿°(å¦‚: åªçœ‹æ•´ä½“æ•°æ®,æœªåˆ†å±‚åˆ†æž)",
          "consequence": "åŽæžœ(å¦‚: è¯¯è®¤ä¸ºäº§å“æ•´ä½“å˜å·®,æµªè´¹èµ„æº)",
          "correction": "æ­£ç¡®åšæ³•(å¦‚: å§‹ç»ˆæŒ‰å…³é”®ç»´åº¦åˆ†å±‚æŸ¥çœ‹æ•°æ®)"
        }
      ],

      "transferableSkills": [
        "å¯è¿ç§»æŠ€èƒ½1(å¦‚: åˆ†å±‚åˆ†æžæŠ€å·§å¯åº”ç”¨äºŽä»»ä½•èšåˆæŒ‡æ ‡çš„è¯Šæ–­)",
        "å¯è¿ç§»æŠ€èƒ½2(å¦‚: å˜é‡æŽ§åˆ¶æ€ç»´å¯ç”¨äºŽéªŒè¯ä»»ä½•å› æžœå‡è®¾)",
        "å¯è¿ç§»æŠ€èƒ½3"
      ],

      "practiceGuidance": "ç»ƒä¹ å¼•å¯¼(50-80å­—,å¦‚: å®Œæˆæœ¬æ¡ˆä¾‹å­¦ä¹ åŽ,å»ºè®®è®¿é—®ç»ƒä¹ ç³»ç»Ÿ,å°è¯•åˆ†æžç±»ä¼¼é—®é¢˜)"
    }
  ]
}

## è´¨é‡è¦æ±‚ (å¿…é¡»ä¸¥æ ¼éµå®ˆ!)

### ç†è®ºå…³è” (æ ¸å¿ƒè¦æ±‚!)
- âœ… **æ¯ä¸ªåˆ†æžæ­¥éª¤å¿…é¡»æ ‡æ³¨conceptApplied** - ä½¿ç”¨äº†å“ªä¸ªæ¦‚å¿µ
- âœ… è‡³å°‘50%çš„æ­¥éª¤è¦æ ‡æ³¨modelApplied - ä½¿ç”¨äº†å“ªä¸ªæ¨¡åž‹
- âœ… theoreticalFoundationå¿…é¡»åˆ—å‡ºæ‰€æœ‰ä½¿ç”¨çš„æ¦‚å¿µå’Œæ¨¡åž‹

### åˆ†æžæ·±åº¦
- âœ… **æ¯ä¸ªæ­¥éª¤thinkingProcesså¿…é¡»â‰¥200å­—**
- âœ… æ¯ä¸ªæ­¥éª¤å¿…é¡»æœ‰criticalThinkingPoint(80-120å­—)
- âœ… æ¯ä¸ªæ­¥éª¤å¿…é¡»æœ‰nextStepRationale

### å¯è¿ç§»æ€§
- âœ… å¿…é¡»æç‚¼3-5ä¸ªkeyInsights(æ¯ä¸ªåŒ…å«generalPrinciple)
- âœ… å¿…é¡»åˆ—å‡º2-4ä¸ªcommonMistakesInThisCase
- âœ… å¿…é¡»åˆ—å‡º3-5ä¸ªtransferableSkills

${getLevelDemoComplexityGuidance(level)}

## ðŸš¨ æœ€åŽæé†’ - JSONæ ¼å¼è¦æ±‚

1. **ç›´æŽ¥è¾“å‡ºJSONå¯¹è±¡** - ç¬¬ä¸€ä¸ªå­—ç¬¦å°±æ˜¯ { , æœ€åŽä¸€ä¸ªå­—ç¬¦æ˜¯ }
2. **ä¸è¦ä½¿ç”¨markdownä»£ç å—** - ä¸è¦æœ‰ \`\`\`json è¿™æ ·çš„åŒ…è£¹
3. **ç¡®ä¿JSONå®Œæ•´** - æ‰€æœ‰å¯¹è±¡å’Œæ•°ç»„å¿…é¡»æ­£ç¡®é—­åˆ
4. **ç‰¹æ®Šå­—ç¬¦è½¬ä¹‰** - å­—ç¬¦ä¸²ä¸­çš„å¼•å·ã€æ¢è¡Œç¬¦ç­‰å¿…é¡»æ­£ç¡®è½¬ä¹‰
5. **æ¯æ­¥æ ‡æ³¨conceptApplied** - è¿™æ˜¯æ ¸å¿ƒè¦æ±‚,ä¸èƒ½é—æ¼!

**æ­£ç¡®ç¤ºä¾‹**: { "intro": "...", "demonstrations": [{...}] }
**é”™è¯¯ç¤ºä¾‹**: \`\`\`json\\n{ "intro": "...", "demonstrations": [{...}] }\\n\`\`\`

çŽ°åœ¨,è¯·ç›´æŽ¥è¾“å‡ºç¬¦åˆä¸Šè¿°è¦æ±‚çš„JSONå¯¹è±¡:`;
}

/**
 * Helper: Get concept count based on level
 */
function getLevelConceptCount(level: number): string {
  if (level === 1) return '1-2';
  if (level >= 2 && level <= 3) return '2-3';
  return '2-3';
}

/**
 * Helper: Get level-specific difficulty guidance for concepts
 */
function getLevelDifficultyGuidance(level: number): string {
  if (level === 1) {
    return `### Level 1 éš¾åº¦è¦æ±‚ (åŸºç¡€è¯†åˆ«)
- 1-2ä¸ªåŸºç¡€æ¦‚å¿µ
- æ¦‚å¿µç®€å•ç›´æŽ¥,å®šä¹‰æ¸…æ™°
- ä¾‹å­æ¥è‡ªæ—¥å¸¸ç”Ÿæ´»
- conceptBreakdownåªéœ€level1`;
  }

  if (level >= 2 && level <= 3) {
    return `### Level ${level} éš¾åº¦è¦æ±‚ (ä¸­çº§åº”ç”¨)
- 2-3ä¸ªæ¦‚å¿µ
- å¼•å…¥å…³ç³»å’Œåº”ç”¨
- ä¾‹å­æ¶‰åŠå·¥ä½œå­¦ä¹ åœºæ™¯
- conceptBreakdownéœ€è¦level1+level2`;
  }

  return `### Level ${level} éš¾åº¦è¦æ±‚ (é«˜çº§ç»¼åˆ)
- 2-3ä¸ªé«˜çº§æ¦‚å¿µ
- å¼ºè°ƒç³»ç»Ÿæ€§å’Œå¤æ‚æ€§
- ä¾‹å­æ¶‰åŠå¤æ‚çœŸå®žåœºæ™¯
- conceptBreakdownéœ€è¦level1+level2+level3`;
}

/**
 * Helper: Get model complexity guidance based on level
 */
function getLevelModelComplexityGuidance(level: number): string {
  if (level === 1) {
    return `### Leveléš¾åº¦é€’å¢ž
- Level 1: 1ä¸ªç®€å•çº¿æ€§æ¨¡åž‹(3-4æ­¥)`;
  }

  if (level >= 2 && level <= 3) {
    return `### Leveléš¾åº¦é€’å¢ž
- Level ${level}: 1-2ä¸ªç»“æž„åŒ–æ¨¡åž‹(5-6æ­¥)`;
  }

  return `### Leveléš¾åº¦é€’å¢ž
- Level ${level}: 1-2ä¸ªå¤æ‚ç³»ç»Ÿæ¨¡åž‹(6-8æ­¥)`;
}

/**
 * Helper: Get demonstration complexity guidance based on level
 */
function getLevelDemoComplexityGuidance(level: number): string {
  if (level === 1) {
    return `### Leveléš¾åº¦é€’å¢ž
- Level 1: 1-2ä¸ªç®€å•æ¡ˆä¾‹,3-5ä¸ªåˆ†æžæ­¥éª¤`;
  }

  if (level >= 2 && level <= 3) {
    return `### Leveléš¾åº¦é€’å¢ž
- Level ${level}: 2ä¸ªä¸­ç­‰æ¡ˆä¾‹,5-7ä¸ªåˆ†æžæ­¥éª¤`;
  }

  return `### Leveléš¾åº¦é€’å¢ž
- Level ${level}: 1-2ä¸ªå¤æ‚æ¡ˆä¾‹,7-10ä¸ªåˆ†æžæ­¥éª¤`;
}
